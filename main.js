/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===_typeof(i)?i:String(i)),n)}var o,i}var t=function(){function EventEmitter(){!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,EventEmitter),this._events=new Map}return function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(EventEmitter,[{key:"on",value:function on(t,e){var r;this._events.has(t)||this._events.set(t,new Set),null===(r=this._events.get(t))||void 0===r||r.add(e)}},{key:"off",value:function off(t,e){var r;this._events.has(t)&&(this._events.get(t).delete(e),0===(null===(r=this._events.get(t))||void 0===r?void 0:r.size)&&this._events.delete(t))}},{key:"emit",value:function emit(t,e){this._events.forEach((function(r,n){"*"===n&&r.forEach((function(r){return r({eventName:t,data:e})})),(n instanceof RegExp&&n.test(t)||n===t)&&r.forEach((function(t){return t(e)}))}))}},{key:"onAll",value:function onAll(t){this.on("*",t)}},{key:"offAll",value:function offAll(){this._events=new Map}},{key:"trigger",value:function trigger(t,e){var r=this;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.emit(t,Object.assign(Object.assign({},n||{}),e||{}))}}}]),EventEmitter}();function api_typeof(t){return api_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},api_typeof(t)}function api_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function api_toPrimitive(t,e){if("object"!==api_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==api_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===api_typeof(i)?i:String(i)),n)}var o,i}function api_interpretator_typeof(t){return api_interpretator_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},api_interpretator_typeof(t)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,o){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),u=new Context(o||[]);return n(a,"_invoke",{value:makeInvokeMethod(t,r,u)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var c={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var s={};define(s,i,(function(){return this}));var l=Object.getPrototypeOf,f=l&&l(l(values([])));f&&f!==e&&r.call(f,i)&&(s=f);var d=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(s);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(n,o,i,a){var u=tryCatch(t[n],t,o);if("throw"!==u.type){var c=u.arg,s=c.value;return s&&"object"==api_interpretator_typeof(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(s).then((function(t){c.value=t,i(c)}),(function(t){return invoke("throw",t,i,a)}))}a(u.arg)}var o;n(this,"_invoke",{value:function value(t,r){function callInvokeWithMethodAndArg(){return new e((function(e,n){invoke(t,r,e,n)}))}return o=o?o.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return doneResult()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=maybeInvokeDelegate(a,r);if(u){if(u===c)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=tryCatch(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===c)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function maybeInvokeDelegate(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,maybeInvokeDelegate(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),c;var o=tryCatch(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,c;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function next(){for(;++n<t.length;)if(r.call(t,n))return next.value=t[n],next.done=!1,next;return next.value=void 0,next.done=!0,next};return o.next=o}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,n(d,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),n(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(d),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,a,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(d),define(d,u,"Generator"),define(d,i,(function(){return this})),define(d,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var e=this;function handle(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return handle("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0);if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),c}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,e,r){return this.delegate={iterator:values(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},t}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function _next(t){asyncGeneratorStep(i,n,o,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(i,n,o,_next,_throw,"throw",t)}_next(void 0)}))}}function api_interpretator_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function api_interpretator_toPrimitive(t,e){if("object"!==api_interpretator_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==api_interpretator_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===api_interpretator_typeof(i)?i:String(i)),n)}var o,i}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createSuper(t){var e=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function _possibleConstructorReturn(t,e){if(e&&("object"===api_interpretator_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}var e=function(t){!function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}(apiInterpretator,t);var e,r,n=_createSuper(apiInterpretator);function apiInterpretator(t,e){return function api_interpretator_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,apiInterpretator),n.call(this,t,e)}return function api_interpretator_createClass(t,e,r){return e&&api_interpretator_defineProperties(t.prototype,e),r&&api_interpretator_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(apiInterpretator,[{key:"loadProducts",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var t,e;return _regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.get("/product/");case 2:return t=r.sent,e=t,r.abrupt("return",Array.isArray(e.items)?e.items:[]);case 5:case"end":return r.stop()}}),_callee,this)}))),function loadProducts(){return r.apply(this,arguments)})},{key:"createOrder",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(t){var e;return _regeneratorRuntime().wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.post("/order",t);case 2:return e=r.sent,r.abrupt("return",e);case 4:case"end":return r.stop()}}),_callee2,this)}))),function createOrder(t){return e.apply(this,arguments)})}]),apiInterpretator}(function(){function Api(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function api_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Api),this.baseUrl=t,this.options={headers:Object.assign({"Content-Type":"application/json"},null!==(e=r.headers)&&void 0!==e?e:{})}}return function api_createClass(t,e,r){return e&&api_defineProperties(t.prototype,e),r&&api_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Api,[{key:"handleResponse",value:function handleResponse(t){return t.ok?t.json():t.json().then((function(e){var r;return Promise.reject(null!==(r=e.error)&&void 0!==r?r:t.statusText)}))}},{key:"get",value:function get(t){return fetch(this.baseUrl+t,Object.assign(Object.assign({},this.options),{method:"GET"})).then(this.handleResponse)}},{key:"post",value:function post(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch(this.baseUrl+t,Object.assign(Object.assign({},this.options),{method:r,body:JSON.stringify(e)})).then(this.handleResponse)}}]),Api}());function Catalog_typeof(t){return Catalog_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Catalog_typeof(t)}function Catalog_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function Catalog_toPrimitive(t,e){if("object"!==Catalog_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Catalog_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Catalog_typeof(i)?i:String(i)),n)}var o,i}var r=function(){function Catalog(){!function Catalog_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Catalog)}return function Catalog_createClass(t,e,r){return e&&Catalog_defineProperties(t.prototype,e),r&&Catalog_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Catalog,[{key:"setProducts",value:function setProducts(t){this.products=t}},{key:"getProducts",value:function getProducts(){return this.products}},{key:"getProduct",value:function getProduct(t){return this.products.find((function(e){return e.id===t}))}},{key:"selectProduct",value:function selectProduct(t){if(!this.products.some((function(e){return e.id===t})))throw new Error('Product with id "'.concat(t,'" not found'));this.selectedProductId=t}},{key:"getSelected",value:function getSelected(){var t=this;return null===this.selectedProductId?null:this.products.find((function(e){return e.id=t.selectedProductId}))}}]),Catalog}();function Cart_typeof(t){return Cart_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cart_typeof(t)}function Cart_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function Cart_toPrimitive(t,e){if("object"!==Cart_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Cart_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Cart_typeof(i)?i:String(i)),n)}var o,i}var n,o=function(){function Cart(){!function Cart_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Cart),this.products=[]}return function Cart_createClass(t,e,r){return e&&Cart_defineProperties(t.prototype,e),r&&Cart_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Cart,[{key:"addProduct",value:function addProduct(t){this.hasProduct(t.id)||this.products.push(t)}},{key:"removeProduct",value:function removeProduct(t){this.products=this.products.filter((function(e){return e.id!==t}))}},{key:"getItemsCount",value:function getItemsCount(){return this.products.length}},{key:"getItems",value:function getItems(){return this.products}},{key:"clear",value:function clear(){this.products=[]}},{key:"getSubtotal",value:function getSubtotal(){for(var t,e=0,r=0;r<this.products.length;r++)e+=null!==(t=this.products[r].price)&&void 0!==t?t:0;return e}},{key:"hasProduct",value:function hasProduct(t){return this.products.some((function(e){return e.id===t}))}}]),Cart}();function Customer_typeof(t){return Customer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Customer_typeof(t)}function Customer_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function Customer_toPrimitive(t,e){if("object"!==Customer_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Customer_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Customer_typeof(i)?i:String(i)),n)}var o,i}!function(t){t.Card="card",t.Cash="cash"}(n||(n={}));var i=function(){function Customer(t){var e,r,o,i;!function Customer_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Customer),this.data={payment:null!==(e=null==t?void 0:t.payment)&&void 0!==e?e:n.Cash,address:null!==(r=null==t?void 0:t.address)&&void 0!==r?r:"",email:null!==(o=null==t?void 0:t.email)&&void 0!==o?o:"",phone:null!==(i=null==t?void 0:t.phone)&&void 0!==i?i:""}}return function Customer_createClass(t,e,r){return e&&Customer_defineProperties(t.prototype,e),r&&Customer_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Customer,[{key:"saveData",value:function saveData(t){if(void 0!==t.payment&&!Object.values(n).includes(t.payment))throw new Error("Invalid payment method: ".concat(t.payment));this.data=Object.assign(Object.assign({},this.data),t)}},{key:"getData",value:function getData(){return Object.assign({},this.data)}},{key:"validateData",value:function validateData(){var t;return this.data.address||(t.address="Введите корректный адрес."),this.data.email||(t.email="Введите корректный e-mail."),this.data.phone||(t.phone="Введите корректный телефон."),Object.values(n).includes(this.data.payment)||(t.payment="Неизвестный способ оплаты."),t}}]),Customer}();function isSelector(t){return"string"==typeof t&&t.length>1}function isEmpty(t){return null==t}function formatNumber(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e)}function ensureElement(t,e){if(isSelector(t)){var r=function ensureAllElements(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;if(isSelector(t))return Array.from(e.querySelectorAll(t));if(t instanceof NodeList)return Array.from(t);if(Array.isArray(t))return t;throw new Error("Unknown selector element")}(t,e);if(r.length>1&&console.warn("selector ".concat(t," return more then one element")),0===r.length)throw new Error("selector ".concat(t," return nothing"));return r.pop()}if(t instanceof HTMLElement)return t;throw new Error("Unknown selector element")}function cloneTemplate(t){return ensureElement(t).content.firstElementChild.cloneNode(!0)}function setElementData(t,e){for(var r in e)t.dataset[r]=String(e[r])}var a="".concat("https://larek-api.nomoreparties.co","/api/weblarek"),u="".concat("https://larek-api.nomoreparties.co","/content/weblarek");function GalleryProductCardView_typeof(t){return GalleryProductCardView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GalleryProductCardView_typeof(t)}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return GalleryProductCardView_arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function GalleryProductCardView_unsupportedIterableToArray(t,e){if(!t)return;if("string"==typeof t)return GalleryProductCardView_arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GalleryProductCardView_arrayLikeToArray(t,e)}(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GalleryProductCardView_arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function GalleryProductCardView_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function GalleryProductCardView_toPrimitive(t,e){if("object"!==GalleryProductCardView_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==GalleryProductCardView_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===GalleryProductCardView_typeof(i)?i:String(i)),n)}var o,i}var c=function(){function GalleryProductCardView(t,e){!function GalleryProductCardView_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,GalleryProductCardView),this.events=e,this.root=cloneTemplate(t)}return function GalleryProductCardView_createClass(t,e,r){return e&&GalleryProductCardView_defineProperties(t.prototype,e),r&&GalleryProductCardView_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(GalleryProductCardView,[{key:"render",value:function render(t){var e,r,n=this,o=ensureElement(".card__category",this.root),i=ensureElement(".card__title",this.root),a=ensureElement(".card__image",this.root),c=ensureElement(".card__price",this.root),s=null!==(r=null!==(e=t.category)&&void 0!==e?e:t.categoryLabel)&&void 0!==r?r:"";return o.textContent=s,this.applyCategoryClass(o,s),i.textContent=t.title,t.image&&(a.src=u+t.image,a.alt=t.title),c.textContent=this.formatPrice(t.price),setElementData(this.root,{id:t.id}),this.root.addEventListener("click",(function(e){e.preventDefault(),n.events.emit("card:select",{item:t})})),this.root}},{key:"formatPrice",value:function formatPrice(t){if(isEmpty(t))return"бесценно";var e=Number(t);return Number.isFinite(e)?"".concat(formatNumber(e)," синапсов"):"бесценно"}},{key:"applyCategoryClass",value:function applyCategoryClass(t,e){_toConsumableArray(t.classList).filter((function(t){return t.startsWith("card__category_")})).forEach((function(e){return t.classList.remove(e)}));var r={"софт-скил":"card__category_soft",другое:"card__category_other","хард-скил":"card__category_hard",дополнительное:"card__category_additional",кнопка:"card__category_button"};e&&r[e]&&t.classList.add(r[e])}}]),GalleryProductCardView}();function ProductModalView_typeof(t){return ProductModalView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ProductModalView_typeof(t)}function ProductModalView_toConsumableArray(t){return function ProductModalView_arrayWithoutHoles(t){if(Array.isArray(t))return ProductModalView_arrayLikeToArray(t)}(t)||function ProductModalView_iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function ProductModalView_unsupportedIterableToArray(t,e){if(!t)return;if("string"==typeof t)return ProductModalView_arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ProductModalView_arrayLikeToArray(t,e)}(t)||function ProductModalView_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ProductModalView_arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ProductModalView_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function ProductModalView_toPrimitive(t,e){if("object"!==ProductModalView_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ProductModalView_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===ProductModalView_typeof(i)?i:String(i)),n)}var o,i}var s=function(){function ProductModalView(t,e,r){!function ProductModalView_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ProductModalView),this.events=e,this.root=cloneTemplate(t),this.inCart=!!r.inCart,this.root.classList.add("card","card_full")}return function ProductModalView_createClass(t,e,r){return e&&ProductModalView_defineProperties(t.prototype,e),r&&ProductModalView_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(ProductModalView,[{key:"render",value:function render(t){var e,r,n=this,o=ensureElement(".card__category",this.root),i=ensureElement(".card__title",this.root),a=ensureElement(".card__text",this.root),c=ensureElement(".card__image",this.root),s=ensureElement(".card__button",this.root),l=ensureElement(".card__price",this.root),f=null!==(e=t.category)&&void 0!==e?e:"";o.textContent=f,this.applyCategoryClass(o,f),i.textContent=t.title,a.textContent=null!==(r=t.description)&&void 0!==r?r:"",l.textContent=this.formatPrice(t.price),t.image&&(c.src=u+t.image,c.alt=t.title);var d=isEmpty(t.price),y=function updateBtn(){d?(s.disabled=!0,s.textContent="Недоступно"):(s.disabled=!1,s.textContent=n.inCart?"Удалить из корзины":"В корзину")};return y(),d||s.addEventListener("click",(function(){n.inCart=!n.inCart,n.events.emit("cart:toggle",{product:t,inCart:n.inCart}),y()})),this.root.dataset.id=t.id,this.root}},{key:"formatPrice",value:function formatPrice(t){if(isEmpty(t))return"Бесценно";var e=Number(t);return Number.isFinite(e)?"".concat(formatNumber(e)," синапсов"):"0 синапсов"}},{key:"applyCategoryClass",value:function applyCategoryClass(t,e){ProductModalView_toConsumableArray(t.classList).filter((function(t){return t.startsWith("card__category_")})).forEach((function(e){return t.classList.remove(e)}));var r={"софт-скил":"card__category_soft",другое:"card__category_other","хард-скил":"card__category_hard",дополнительное:"card__category_additional",кнопка:"card__category_button"};e&&r[e]&&t.classList.add(r[e])}}]),ProductModalView}();function CartView_typeof(t){return CartView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CartView_typeof(t)}function CartView_toConsumableArray(t){return function CartView_arrayWithoutHoles(t){if(Array.isArray(t))return CartView_arrayLikeToArray(t)}(t)||function CartView_iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function CartView_unsupportedIterableToArray(t,e){if(!t)return;if("string"==typeof t)return CartView_arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CartView_arrayLikeToArray(t,e)}(t)||function CartView_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CartView_arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function CartView_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function CartView_toPrimitive(t,e){if("object"!==CartView_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==CartView_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===CartView_typeof(i)?i:String(i)),n)}var o,i}var l=function(){function CartView(t,e,r){!function CartView_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,CartView),this.tpl=t,this.itemTpl=e,this.events=r}return function CartView_createClass(t,e,r){return e&&CartView_defineProperties(t.prototype,e),r&&CartView_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(CartView,[{key:"render",value:function render(t,e){var r,n=this;this.root=cloneTemplate(this.tpl),this.listEl=ensureElement(".basket__list",this.root),this.totalEl=ensureElement(".basket__price",this.root),this.CartIsEmpty=ensureElement(".modal__text",this.root),this.CartIsEmpty.textContent="Корзина пуста",this.orderBtn=ensureElement(".basket__button",this.root);var o=t.map((function(e,r){var o,i=cloneTemplate(n.itemTpl);return n.CartIsEmpty.textContent=t?"":"Корзина пуста",ensureElement(".basket__item-index",i).textContent=String(r+1),ensureElement(".card__title",i).textContent=e.title,ensureElement(".card__price",i).textContent="".concat(formatNumber(Number(null!==(o=e.price)&&void 0!==o?o:0))," синапсов"),ensureElement(".basket__item-delete",i).addEventListener("click",(function(){return n.events.emit("cart:remove",{id:e.id})})),i}));return(r=this.listEl).replaceChildren.apply(r,CartView_toConsumableArray(o)),this.totalEl.textContent="".concat(formatNumber(e)," синапсов"),this.orderBtn.disabled=0===t.length,this.orderBtn.addEventListener("click",(function(){return n.events.emit("order:open")})),this.root}}]),CartView}();function ContactsFormView_typeof(t){return ContactsFormView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ContactsFormView_typeof(t)}function ContactsFormView_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function ContactsFormView_toPrimitive(t,e){if("object"!==ContactsFormView_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ContactsFormView_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===ContactsFormView_typeof(i)?i:String(i)),n)}var o,i}var f=function(){function ContactsFormView(t,e,r){!function ContactsFormView_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ContactsFormView),this.events=e,this.customer=r,this.root=cloneTemplate(t);var n=this.root;this.form=n,this.emailInput=ensureElement('input[name="email"]',this.form),this.phoneInput=ensureElement('input[name="phone"]',this.form),this.submitBtn=ensureElement('button[type="submit"]',this.form),this.errorsEl=ensureElement(".form__errors",this.form),this.attach(),this.hydrate(),this.updateUI()}return function ContactsFormView_createClass(t,e,r){return e&&ContactsFormView_defineProperties(t.prototype,e),r&&ContactsFormView_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(ContactsFormView,[{key:"render",value:function render(){return this.root}},{key:"attach",value:function attach(){var t=this;this.emailInput.addEventListener("input",(function(){t.customer.saveData({email:t.emailInput.value.trim()}),t.updateUI()})),this.phoneInput.addEventListener("input",(function(){t.customer.saveData({phone:t.phoneInput.value.trim()}),t.updateUI()})),this.form.addEventListener("submit",(function(e){e.preventDefault(),t.validate().valid&&t.events.emit("order:submit",{customer:t.customer.getData()})}))}},{key:"hydrate",value:function hydrate(){var t,e,r=this.customer.getData();this.emailInput.value=null!==(t=r.email)&&void 0!==t?t:"",this.phoneInput.value=null!==(e=r.phone)&&void 0!==e?e:""}},{key:"validate",value:function validate(){var t=this.customer.getData(),e={payment:void 0,address:void 0,email:void 0,phone:void 0};return t.email&&t.email.trim()||(e.email="Введите e-mail."),t.phone&&t.phone.trim()||(e.phone="Введите телефон."),{valid:!e.email&&!e.phone,errors:e}}},{key:"updateUI",value:function updateUI(){var t=this.validate(),e=t.valid,r=t.errors;this.submitBtn.disabled=!e,this.errorsEl.textContent=e?"":[r.email,r.phone].filter(Boolean).join(" ")}}]),ContactsFormView}();function SuccessView_typeof(t){return SuccessView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SuccessView_typeof(t)}function SuccessView_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function SuccessView_toPrimitive(t,e){if("object"!==SuccessView_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==SuccessView_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===SuccessView_typeof(i)?i:String(i)),n)}var o,i}var d=function(){function SuccessView(t,e){var r=this;!function SuccessView_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,SuccessView),this.events=e,this.root=cloneTemplate(t),this.titleEl=ensureElement(".order-success__title",this.root),this.descEl=ensureElement(".order-success__description",this.root),this.closeBtn=ensureElement(".order-success__close",this.root),this.closeBtn.addEventListener("click",(function(){r.events.emit("order:success:close")}))}return function SuccessView_createClass(t,e,r){return e&&SuccessView_defineProperties(t.prototype,e),r&&SuccessView_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(SuccessView,[{key:"render",value:function render(t){return this.descEl.textContent="Списано ".concat(formatNumber(t)," синапсов"),this.root}}]),SuccessView}();function Modal_typeof(t){return Modal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Modal_typeof(t)}function Modal_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function Modal_toPrimitive(t,e){if("object"!==Modal_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Modal_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Modal_typeof(i)?i:String(i)),n)}var o,i}var y=function(){function Modal(t,e){var r,n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function Modal_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Modal),this.onEsc=function(t){"Escape"===t.key&&n.close()},this.container="string"==typeof t?ensureElement(t):t,this.contentEl=ensureElement(".modal__content",this.container),this.closeBtn=ensureElement(".modal__close",this.container),this.events=e,this.activeClass=null!==(r=o.activeClass)&&void 0!==r?r:"modal_active",this.closeBtn.addEventListener("click",(function(){return n.close()})),this.container.addEventListener("click",(function(t){t.target===n.container&&n.close()}))}return function Modal_createClass(t,e,r){return e&&Modal_defineProperties(t.prototype,e),r&&Modal_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Modal,[{key:"setContent",value:function setContent(t){this.contentEl.replaceChildren(t)}},{key:"open",value:function open(t){var e;t&&this.setContent(t),this.container.classList.add(this.activeClass),this.container.setAttribute("aria-hidden","false"),null===(e=this.events)||void 0===e||e.emit("modal:open"),document.body.style.overflow="hidden",document.addEventListener("keydown",this.onEsc)}},{key:"close",value:function close(){var t;this.container.classList.contains(this.activeClass)&&(this.container.classList.remove(this.activeClass),this.container.setAttribute("aria-hidden","true"),null===(t=this.events)||void 0===t||t.emit("modal:close"),document.body.style.overflow="",document.removeEventListener("keydown",this.onEsc))}}]),Modal}();function OrderPageView_typeof(t){return OrderPageView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OrderPageView_typeof(t)}function OrderPageView_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function OrderPageView_toPrimitive(t,e){if("object"!==OrderPageView_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==OrderPageView_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===OrderPageView_typeof(i)?i:String(i)),n)}var o,i}var p=function(){function OrderFormView(t,e,r){!function OrderPageView_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,OrderFormView),this.events=e,this.customer=r,this.root=cloneTemplate(t);var n=this.root;this.form=n,this.btnCard=ensureElement('button[name="card"]',this.root),this.btnCash=ensureElement('button[name="cash"]',this.root),this.addressInput=ensureElement('input[name="address"]',this.root),this.submitBtn=ensureElement('button[type="submit"]',this.root),this.errorsEl=ensureElement(".form__errors",this.root),this.attachEvents(),this.hydrateFromModel(),this.updateUI()}return function OrderPageView_createClass(t,e,r){return e&&OrderPageView_defineProperties(t.prototype,e),r&&OrderPageView_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(OrderFormView,[{key:"render",value:function render(){return this.root}},{key:"attachEvents",value:function attachEvents(){var t=this;this.btnCard.addEventListener("click",(function(){t.customer.saveData({payment:n.Card}),t.updateUI()})),this.btnCash.addEventListener("click",(function(){t.customer.saveData({payment:n.Cash}),t.updateUI()})),this.addressInput.addEventListener("input",(function(){t.customer.saveData({address:t.addressInput.value.trim()}),t.updateUI()})),this.form.addEventListener("submit",(function(e){e.preventDefault(),t.validateStep().valid&&t.events.emit("order:step1:submit",{customer:t.customer.getData()})}))}},{key:"hydrateFromModel",value:function hydrateFromModel(){var t,e=this.customer.getData();this.addressInput.value=null!==(t=e.address)&&void 0!==t?t:"",this.syncPaymentButtons(e.payment)}},{key:"syncPaymentButtons",value:function syncPaymentButtons(t){var e=t===n.Card||"card"===t,r=t===n.Cash||"cash"===t;this.btnCard.classList.toggle("button_alt-active",!!e),this.btnCash.classList.toggle("button_alt-active",!!r),this.btnCard.setAttribute("aria-pressed",String(!!e)),this.btnCash.setAttribute("aria-pressed",String(!!r))}},{key:"validateStep",value:function validateStep(){var t=this.customer.getData(),e={payment:void 0,address:void 0,email:void 0,phone:void 0};return t.payment!==n.Card&&t.payment!==n.Cash&&(e.payment="Выберите способ оплаты."),t.address&&t.address.trim()||(e.address="Введите адрес доставки."),{valid:!e.payment&&!e.address,errors:e}}},{key:"updateUI",value:function updateUI(){var t=this.customer.getData();this.syncPaymentButtons(t.payment);var e=this.validateStep(),r=e.valid,n=e.errors;this.submitBtn.disabled=!r,this.errorsEl.textContent=r?"":[n.payment,n.address].filter(Boolean).join(" ")}}]),OrderFormView}();function src_typeof(t){return src_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},src_typeof(t)}function src_regeneratorRuntime(){src_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,o){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),u=new Context(o||[]);return n(a,"_invoke",{value:makeInvokeMethod(t,r,u)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var c={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var s={};define(s,i,(function(){return this}));var l=Object.getPrototypeOf,f=l&&l(l(values([])));f&&f!==e&&r.call(f,i)&&(s=f);var d=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(s);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(n,o,i,a){var u=tryCatch(t[n],t,o);if("throw"!==u.type){var c=u.arg,s=c.value;return s&&"object"==src_typeof(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(s).then((function(t){c.value=t,i(c)}),(function(t){return invoke("throw",t,i,a)}))}a(u.arg)}var o;n(this,"_invoke",{value:function value(t,r){function callInvokeWithMethodAndArg(){return new e((function(e,n){invoke(t,r,e,n)}))}return o=o?o.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return doneResult()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=maybeInvokeDelegate(a,r);if(u){if(u===c)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=tryCatch(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===c)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function maybeInvokeDelegate(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,maybeInvokeDelegate(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),c;var o=tryCatch(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,c;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function next(){for(;++n<t.length;)if(r.call(t,n))return next.value=t[n],next.done=!1,next;return next.value=void 0,next.done=!0,next};return o.next=o}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,n(d,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),n(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(d),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,a,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(d),define(d,u,"Generator"),define(d,i,(function(){return this})),define(d,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var e=this;function handle(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return handle("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0);if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),c}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,e,r){return this.delegate={iterator:values(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},t}function src_asyncGeneratorStep(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function src_asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function _next(t){src_asyncGeneratorStep(i,n,o,_next,_throw,"next",t)}function _throw(t){src_asyncGeneratorStep(i,n,o,_next,_throw,"throw",t)}_next(void 0)}))}}function src_toConsumableArray(t){return function src_arrayWithoutHoles(t){if(Array.isArray(t))return src_arrayLikeToArray(t)}(t)||function src_iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function src_unsupportedIterableToArray(t,e){if(!t)return;if("string"==typeof t)return src_arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return src_arrayLikeToArray(t,e)}(t)||function src_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function src_arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var h=ensureElement(".gallery"),m=ensureElement("#modal-container"),v=ensureElement(".header__basket"),b=ensureElement(".header__basket-counter",v),_=ensureElement("#card-catalog"),g=ensureElement("#card-preview"),w=ensureElement("#basket"),C=ensureElement("#card-basket"),P=ensureElement("#order"),E=ensureElement("#contacts"),S=ensureElement("#success"),k=new t,x=new e(a),V=new r,O=new o,j=new i,A=new y(m,k,{activeClass:"modal_active"}),I=new l(w,C,k);k.onAll((function(t){var e=t.eventName,r=t.data;return console.log("[evt]",e,r)}));var L,T=function updateBasketCounter(){b.textContent=String(O.getItemsCount())};v.addEventListener("click",(function(){k.emit("basket:open")})),k.on("catalogList:changed",(function(){var t=V.getProducts().map((function(t){return new c(_,k).render(t)}));h.replaceChildren.apply(h,src_toConsumableArray(t))})),k.on("card:select",(function(t){var e=t.item,r=V.getProduct(e.id);if(r){var n=new s(g,k,{inCart:O.hasProduct(r.id)});A.open(n.render(r))}})),k.on("basket:open",(function(){A.open(I.render(O.getItems(),O.getSubtotal()))})),k.on("basket:changed",(function(t){var e=t.items,r=t.total;T(),m.classList.contains("modal_active")&&!!m.querySelector(".basket")&&A.setContent(I.render(e,r))})),k.on("cart:toggle",(function(t){var e=t.product,r=t.inCart;if(null!=e.price){var n=O.hasProduct(e.id);"boolean"==typeof r?(r&&!n&&O.addProduct(e),!r&&n&&O.removeProduct(e.id)):n?O.removeProduct(e.id):O.addProduct(e),k.emit("basket:changed",{items:O.getItems(),total:O.getSubtotal()})}})),k.on("cart:remove",(function(t){var e=t.id;O.removeProduct(e),k.emit("basket:changed",{items:O.getItems(),total:O.getSubtotal()})})),k.on("order:open",(function(){if(0!==O.getItemsCount()){var t=new p(P,k,j);A.setContent(t.render())}})),k.on("order:step1:submit",(function(){var t=new f(E,k,j);A.setContent(t.render())})),k.on("order:submit",src_asyncToGenerator(src_regeneratorRuntime().mark((function _callee(){var t,e,r,o,i,a,u,c;return src_regeneratorRuntime().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return e=j.getData(),r=O.getItems().map((function(t){return t.id})),o=O.getSubtotal(),i={payment:e.payment===n.Card?"online":"cash",email:e.email,phone:e.phone,address:e.address,total:o,items:r},s.prev=4,s.next=7,x.createOrder(i);case 7:a=s.sent,u=Number(null!==(t=null==a?void 0:a.total)&&void 0!==t?t:o),j.saveData({payment:n.Cash,address:"",email:"",phone:""}),c=new d(S,k),A.setContent(c.render(u)),s.next=17;break;case 14:s.prev=14,s.t0=s.catch(4),console.error("Order error:",s.t0);case 17:case"end":return s.stop()}}),_callee,null,[[4,14]])})))),k.on("order:success:close",(function(){O.clear(),k.emit("basket:changed",{items:O.getItems(),total:O.getSubtotal()}),A.close()})),(L=src_asyncToGenerator(src_regeneratorRuntime().mark((function _callee2(){var t;return src_regeneratorRuntime().wrap((function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.loadProducts();case 2:t=e.sent,V.setProducts(t),T(),k.emit("catalogList:changed");case 6:case"end":return e.stop()}}),_callee2)}))),function init(){return L.apply(this,arguments)})()})();
//# sourceMappingURL=main.js.map